clc
beep off
clear all
close all
format short g

set(0,'units','centimeters','defaultfigureposition',[60 60 420,330])

clc
close all
clear all
%%
figure(201)
t=[0 3.8 4.7];
tt=-1:.01:5;
X=[1.3 5.1 6.5];

plot(t,X,'+k');hold all
axis([-1 5 -3 8])

xlabel('\it\bft')
ylabel('\it\bfX')
p=3;
A=[ [1;1;1] sin(2*pi/p*t)' cos(2*pi/p*t)'];
b=X';
ss=A\b
xx=ss(1)+ss(2)*sin(2*pi/p*tt)+ss(3)*cos(2*pi/p*tt);
hold all
plot(tt,xx)     % plot the contributions to the model and the model
plot(tt,[ss(1)*ones(size(tt));ss(2)*sin(2*pi/p*tt);ss(3)*cos(2*pi/p*tt)],'g')
legend('data','model','contributions')
%%
figure(202)
%case 2b upsample and add noise to the measured data
TT=-1:.1:5;
X=2+3*cos(2*pi/p*TT)+4*sin(2*pi/p*TT);
xx=2+3*cos(2*pi/p*tt)+4*sin(2*pi/p*tt);
XX=X+10*randn(size(X)); % generate some noisy data. If you want the data in the notes, uncomment the below
% XX=[-15.3199568259546,17.9651628693119,-8.79032275835488,5.26596715161230,-7.67083952123962,4.13498508326069,3.05176592345012,-6.95208993668081,4.70272688683817,5.17003615650848,13.8442400548430,-12.8228840782966,-7.33597671484253,11.2515269345958,19.9233362425925,9.34170907376145,13.5029905749913,15.2593392361687,21.4984178824379,-14.9247650100548,11.3502797490253,5.19049779275462,1.51950883831629,11.1165933213026,-5.81936454453537,6.47901539171965,-14.7650172520993,-6.88585099625191,8.61962835038475,7.83034035209652,-8.58794892517371,5.07623673202493,4.01347147325099,-6.43243197184255,-16.3659395529959,2.15971340368805,0.0362825583399933,-13.5938531679295,20.4988077307357,-5.36888734606400,1.34481655890849,11.2326535008554,4.65661533056504,4.48841715791632,-2.19545769256870,20.0533679457242,20.4316825667149,15.4091844389502,-9.40274123211029,2.93496211154690,9.39382977185353,-2.89692478745442,10.2177572836107,4.71950354720343,-4.60808709138529,1.77902551566116,3.57522206270409,4.76384192987643,-21.7835303052881,9.70463394208042,3.78122582170990];

A=[ ones(size(TT))' sin(2*pi/p*TT)' cos(2*pi/p*TT)'];
ss=A\XX'
% plot the outcomes compared to the original model
Xx=ss(1)+ss(2)*sin(2*pi/p*tt)+ss(3)*cos(2*pi/p*tt);
plot(TT,XX,'+k',tt,xx,tt,Xx)
xlabel('\it\bft')
ylabel('\it\bfX')
legend('data','original','model')



