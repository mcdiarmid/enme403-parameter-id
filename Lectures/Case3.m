clc
beep off
clear all
close all
format short g
set(0,'units','centimeters','defaultfigureposition',[60 60 420,330])

t=0:.01:10;
stp=zeros(size(t));     %define the temporal vectors
stp(231:end)=1;
rmp=zeros(size(t));
rmp(601:end)=linspace(0,2,length(601:1001));

X=3-.06*sin(2*pi*t)+0.2*cos(2*pi*t)+.1*sin(6.6*pi*t)-.03*cos(6.6*pi*t)+1.3*stp-1.2*rmp; %parent model
XX=X(1:10:end);         % sample the model
XX=XX+0.2*randn(size(XX));                      % add noise to the model, the below line replaces with data from the notes
XX=[2.93821841685499,2.99981680007883,2.85748724278517,2.96886134079214,2.90630075448666,2.40808110838933,2.50695005838961,2.88179675559361,2.98855811791420,3.25667497483245,3.36613601684427,2.88454621915277,3.03301685703872,3.21291323699055,3.01045956400306,2.61245458936512,2.93060307668502,2.82853971775094,2.96785869015874,3.28029366579193,2.93355053389260,3.10596377778306,2.79742431480189,4.22021213059068,4.12144131546983,4.09392236770837,4.21846423955391,4.16705608658836,4.58378232228300,4.31630158782056,4.58851153960201,4.50062847186206,4.65892097882385,4.01380082490199,4.25366595838984,3.68744484510368,4.20769599276367,4.31530296651025,4.17849661887958,4.16580304010926,5.06738768523559,4.27529216329754,3.98571518856021,3.97677119556916,4.11935407222174,4.06916735152041,4.43649116816011,4.25636690433021,4.49555867904859,4.44638296692247,4.42218742787799,4.37759853680184,4.12867882958397,4.17973165680980,4.03977577563238,3.98748962990405,4.37976553535887,4.10126339712623,4.46609387159584,5.07994032679356,4.85303867972469,4.59167005152398,4.25945635727242,4.15734219777567,3.79137887535580,3.82696660189181,3.86275596585444,4.20121774769955,4.05362138513546,4.03202712334600,4.15499612183678,3.80815912336985,3.39907830977730,3.46519631228328,3.64923973392510,3.08567550785716,3.44857868905065,2.91631469129653,3.30947884132012,3.61034344398845,3.63494223710062,2.98527734299619,2.74690345498886,2.85166060779533,2.64686237335509,2.36561266388660,2.59289478938531,2.37610199887602,2.47360207763817,2.93985290366356,2.83505267058722,2.44370417736157,2.08649728345403,1.95894049898910,1.92186476043525,2.14009710296926,1.75443650183620,1.86020637848360,2.05078377347923,2.26579081359011,1.87165448184820];
TT=t(1:10:1001);

% forward simulate the model
A=[ones(size(TT))' sin(2*pi*TT)' cos(2*pi*TT)' sin(6.6*pi*TT)' cos(6.6*pi*TT)' stp([1:10:end])' rmp([1:10:end])'];
b=XX';

ss=A\b                  % define the model outcomes

figure (301)            % plot it
Xm=ss(1)+ss(2)*sin(2*pi*t)+ss(3)*cos(2*pi*t)+ss(4)*sin(6.6*pi*t)+ss(5)*cos(6.6*pi*t)+ss(6)*stp+ss(7)*rmp;
plot(TT,XX,'+k',t,X,t,Xm);hold all
xlabel('\it\bft')
ylabel('\it\bfX')
legend('data','original','model')
